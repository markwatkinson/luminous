<DELIMITER>&lt;%</DELIMITER>
  earliest <OPERATOR>=</OPERATOR> <OBJ>Time</OBJ>.<OO>at</OO>(<VARIABLE>@min_time</VARIABLE>)
  latest <OPERATOR>=</OPERATOR> <OBJ>Time</OBJ>.<OO>at</OO>(<VARIABLE>@max_time</VARIABLE>)

  <COMMENT># adjust to fall on day boundaries</COMMENT>
  earliest <OPERATOR>=</OPERATOR> <OBJ>Time</OBJ>.<OO>mktime</OO>(<OBJ>earliest</OBJ>.<OO>year</OO>, <OBJ>earliest</OBJ>.<OO>month</OO>, <OBJ>earliest</OBJ>.<OO>day</OO>)
  latest <OPERATOR>=</OPERATOR> <OBJ>Time</OBJ>.<OO>mktime</OO>(<OBJ>latest</OBJ>.<OO>year</OO>, <OBJ>latest</OBJ>.<OO>month</OO>, <OBJ>latest</OBJ>.<OO>day</OO>)

  today <OPERATOR>=</OPERATOR> <OBJ>Time</OBJ>.<OO>mktime</OO>(<OBJ>Time</OBJ>.<OO>now</OO>.<OO>year</OO>, <OBJ>Time</OBJ>.<OO>now</OO>.<OO>month</OO>, <OBJ>Time</OBJ>.<OO>now</OO>.<OO>day</OO>)
  first_of_month <OPERATOR>=</OPERATOR> <OBJ>Time</OBJ>.<OO>mktime</OO>(<VARIABLE>@year</VARIABLE> <OPERATOR>||</OPERATOR> <OBJ>Time</OBJ>.<OO>now</OO>.<OO>year</OO>, <VARIABLE>@month</VARIABLE> <OPERATOR>||</OPERATOR> <OBJ>Time</OBJ>.<OO>now</OO>.<OO>month</OO>, <NUMERIC>1</NUMERIC>) <KEYWORD>rescue</KEYWORD> today
  last_of_month <OPERATOR>=</OPERATOR> <OBJ>first_of_month</OBJ>.<OO>end_of_month</OO>

  first_day <OPERATOR>=</OPERATOR> first_of_month <OPERATOR>-</OPERATOR> <OBJ>first_of_month</OBJ>.<OO>wday</OO>.<OO>days</OO>
  last_day <OPERATOR>=</OPERATOR> last_of_month <OPERATOR>+</OPERATOR> (<NUMERIC>6</NUMERIC> <OPERATOR>-</OPERATOR> <OBJ>last_of_month</OBJ>.<OO>wday</OO>).<OO>days</OO>

  d <OPERATOR>=</OPERATOR> first_day
<DELIMITER>-%&gt;</DELIMITER>
&lt;<HTMLTAG>table</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base"</STRING> <TYPE>cellspacing</TYPE>=<STRING>"0"</STRING> <TYPE>cellpadding</TYPE>=<STRING>"0"</STRING> <TYPE>border</TYPE>=<STRING>"0"</STRING>&gt;
  &lt;<HTMLTAG>tr</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;S&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;M&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;T&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;W&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;T&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;F&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>dow"</STRING>&gt;S&lt;<HTMLTAG>/div</HTMLTAG>&gt;&lt;<HTMLTAG>/td</HTMLTAG>&gt;
  &lt;<HTMLTAG>/tr</HTMLTAG>&gt;
  <DELIMITER>&lt;%</DELIMITER> <KEYWORD>while</KEYWORD> d <OPERATOR>&lt;=</OPERATOR> last_day <DELIMITER>-%&gt;</DELIMITER>
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>if</KEYWORD> <OBJ>d</OBJ>.<OO>wday</OO> <OPERATOR>==</OPERATOR> <NUMERIC>0</NUMERIC> <DELIMITER>%&gt;</DELIMITER>
  &lt;<HTMLTAG>tr</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base"</STRING>&gt;
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>end</KEYWORD> <DELIMITER>-%&gt;</DELIMITER>
    &lt;<HTMLTAG>td</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base"</STRING>&gt;
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>if</KEYWORD> d <OPERATOR>&gt;=</OPERATOR> first_of_month <OPERATOR>&amp;&amp;</OPERATOR> d <OPERATOR>&lt;=</OPERATOR> last_of_month <DELIMITER>-%&gt;</DELIMITER>
      &lt;<HTMLTAG>div</HTMLTAG> <TYPE>id</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>day_</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <OBJ>d</OBJ>.<OO>mday</OO> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>"</STRING> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>day_this_month</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@event_days</VARIABLE>[<OBJ>d</OBJ>.<OO>mday</OO>] <OPERATOR>?</OPERATOR> <STRING>" </STRING><DELIMITER>#{</DELIMITER><INTERPOLATION><VARIABLE>@css_prefix</VARIABLE></INTERPOLATION><DELIMITER>}</DELIMITER><STRING>event_day "</STRING> <OPERATOR>+</OPERATOR> (<VARIABLE>@event_days</VARIABLE>[<OBJ>d</OBJ>.<OO>mday</OO>].<OO>css_class</OO> <OPERATOR>||</OPERATOR> <STRING>'calendar1'</STRING>) <OPERATOR>:</OPERATOR> <STRING>''</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> d <OPERATOR>==</OPERATOR> today <OPERATOR>?</OPERATOR> <STRING>" </STRING><DELIMITER>#{</DELIMITER><INTERPOLATION><VARIABLE>@css_prefix</VARIABLE></INTERPOLATION><DELIMITER>}</DELIMITER><STRING>today"</STRING> <OPERATOR>:</OPERATOR> <STRING>''</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>"</STRING> <DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@event_days</VARIABLE>[<OBJ>d</OBJ>.<OO>mday</OO>] <OPERATOR>?</OPERATOR> <STRING>"onmouseover=<ESC>\"</ESC>this.className += ' </STRING><DELIMITER>#{</DELIMITER><INTERPOLATION><VARIABLE>@event_days</VARIABLE>[<OBJ>d</OBJ>.<OO>mday</OO>].<OO>css_class_hover</OO> <OPERATOR>||</OPERATOR> <STRING>'calendar1_hover'</STRING></INTERPOLATION><DELIMITER>}</DELIMITER><STRING>'; showRollover(this.id, 0, 0, </STRING><DELIMITER>#{</DELIMITER><INTERPOLATION><VARIABLE>@popout_direction</VARIABLE> <OPERATOR>==</OPERATOR> <STRING>'right'</STRING> <OPERATOR>?</OPERATOR> <NUMERIC>15</NUMERIC> <OPERATOR>:</OPERATOR> <OPERATOR>-</OPERATOR><NUMERIC>248</NUMERIC></INTERPOLATION><DELIMITER>}</DELIMITER><STRING>, 4);<ESC>\"</ESC> onmouseout=<ESC>\"</ESC>var classes = this.className.split(' '); classes.pop(); this.className = classes.join(' '); hideRollover(this.id);<ESC>\"</ESC>"</STRING> <OPERATOR>:</OPERATOR> <STRING>''</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER>&gt;&lt;<HTMLTAG>div</HTMLTAG> <TYPE>id</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>day_</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <OBJ>d</OBJ>.<OO>mday</OO> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>_std"</STRING>&gt;<DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <OBJ>d</OBJ>.<OO>mday</OO> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER>&lt;<HTMLTAG>/div</HTMLTAG>&gt;
      <DELIMITER>&lt;%</DELIMITER> <KEYWORD>if</KEYWORD> evt <OPERATOR>=</OPERATOR> <VARIABLE>@event_days</VARIABLE>[<OBJ>d</OBJ>.<OO>mday</OO>] <DELIMITER>%&gt;</DELIMITER>
      &lt;<HTMLTAG>div</HTMLTAG> <TYPE>id</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>day_</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <OBJ>d</OBJ>.<OO>mday</OO> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>_hover"</STRING> <TYPE>style</TYPE>=<STRING>"display: none;"</STRING> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>event_rollover"</STRING>&gt;
        &lt;<HTMLTAG>table</HTMLTAG> <TYPE>cellpadding</TYPE>=<STRING>"0"</STRING> <TYPE>cellspacing</TYPE>=<STRING>"0"</STRING> <TYPE>border</TYPE>=<STRING>"0"</STRING> <TYPE>width</TYPE>=<STRING>"100%"</STRING>&gt;
          &lt;<HTMLTAG>tr</HTMLTAG>&gt;
            &lt;<HTMLTAG>td</HTMLTAG> <TYPE>background</TYPE>=<STRING>"/images/interface/bubble_top</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@popout_direction</VARIABLE> <OPERATOR>==</OPERATOR> <STRING>'right'</STRING> <OPERATOR>?</OPERATOR> <STRING>''</STRING> <OPERATOR>:</OPERATOR> <STRING>'_left'</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>.gif"</STRING> <TYPE>style</TYPE>=<STRING>"padding: </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@popout_direction</VARIABLE> <OPERATOR>==</OPERATOR> <STRING>'right'</STRING> <OPERATOR>?</OPERATOR> <STRING>'4px 7px 0 20px'</STRING> <OPERATOR>:</OPERATOR> <STRING>'4px 20px 0 7px'</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>"</STRING>&gt;
              <DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <OBJ>d</OBJ>.<OO>strftime</OO>(<STRING>"%A, %B "</STRING>) <OPERATOR>+</OPERATOR> <OBJ>d</OBJ>.<OO>strftime</OO>(<STRING>"%d"</STRING>).<OO>to_i</OO>.<OO>to_s</OO> <OPERATOR>+</OPERATOR> <OBJ>d</OBJ>.<OO>strftime</OO>(<STRING>", %Y"</STRING>) </INTERPOLATION><DELIMITER>%&gt;</DELIMITER>
            &lt;<HTMLTAG>/td</HTMLTAG>&gt;
          &lt;<HTMLTAG>/tr</HTMLTAG>&gt;
          &lt;<HTMLTAG>tr</HTMLTAG>&gt;
            &lt;<HTMLTAG>td</HTMLTAG>&gt;
              &lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>event_rollover_body"</STRING> <TYPE>style</TYPE>=<STRING>"border-width: 0 1px 0 1px; border-style: solid; padding: 7px 7px 0 7px; margin-</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@popout_direction</VARIABLE> <OPERATOR>==</OPERATOR> <STRING>'right'</STRING> <OPERATOR>?</OPERATOR> <STRING>'left'</STRING> <OPERATOR>:</OPERATOR> <STRING>'right'</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>: 12px;"</STRING>&gt;
                &lt;<HTMLTAG>b</HTMLTAG>&gt;<DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> evt[<VALUE>:name</VALUE>] </INTERPOLATION><DELIMITER>%&gt;</DELIMITER>&lt;<HTMLTAG>/b</HTMLTAG>&gt;
                <DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <STRING>'&lt;br/&gt;'</STRING> <OPERATOR>+</OPERATOR> evt[<VALUE>:html</VALUE>] <KEYWORD>unless</KEYWORD> evt[<VALUE>:html</VALUE>].<OO>empty?</OO> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER>
              &lt;<HTMLTAG>/div</HTMLTAG>&gt;
            &lt;<HTMLTAG>/td</HTMLTAG>&gt;
          &lt;<HTMLTAG>/tr</HTMLTAG>&gt;
          &lt;<HTMLTAG>tr</HTMLTAG>&gt;
            &lt;<HTMLTAG>td</HTMLTAG>&gt;
              &lt;<HTMLTAG>img</HTMLTAG> <TYPE>src</TYPE>=<STRING>"/images/interface/bubble_bottom</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@popout_direction</VARIABLE> <OPERATOR>==</OPERATOR> <STRING>'right'</STRING> <OPERATOR>?</OPERATOR> <STRING>''</STRING> <OPERATOR>:</OPERATOR> <STRING>'_left'</STRING> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>.gif"</STRING> <TYPE>border</TYPE>=<STRING>"0"</STRING> <TYPE>alt</TYPE>=<STRING>""</STRING> <TYPE>style</TYPE>=<STRING>"float: left"</STRING> /&gt;
            &lt;<HTMLTAG>/td</HTMLTAG>&gt;
          &lt;<HTMLTAG>/tr</HTMLTAG>&gt;
        &lt;<HTMLTAG>/table</HTMLTAG>&gt;
      &lt;<HTMLTAG>/div</HTMLTAG>&gt;
      <DELIMITER>&lt;%</DELIMITER> <KEYWORD>end</KEYWORD> <DELIMITER>-%&gt;</DELIMITER>
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>else</KEYWORD> <DELIMITER>-%&gt;</DELIMITER>
      &lt;<HTMLTAG>div</HTMLTAG> <TYPE>class</TYPE>=<STRING>"</STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>base </STRING><DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <VARIABLE>@css_prefix</VARIABLE> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER><STRING>day_other_month"</STRING>&gt;<DELIMITER>&lt;%=</DELIMITER><INTERPOLATION> <OBJ>d</OBJ>.<OO>mday</OO> </INTERPOLATION><DELIMITER>%&gt;</DELIMITER>&lt;<HTMLTAG>/div</HTMLTAG>&gt;
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>end</KEYWORD> <DELIMITER>-%&gt;</DELIMITER>
    &lt;<HTMLTAG>/div</HTMLTAG>&gt;
    &lt;<HTMLTAG>/td</HTMLTAG>&gt;
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>if</KEYWORD> <OBJ>d</OBJ>.<OO>wday</OO> <OPERATOR>==</OPERATOR> <NUMERIC>6</NUMERIC> <DELIMITER>-%&gt;</DELIMITER>
  &lt;<HTMLTAG>/tr</HTMLTAG>&gt;
    <DELIMITER>&lt;%</DELIMITER> <KEYWORD>end</KEYWORD> <DELIMITER>-%&gt;</DELIMITER>
    <DELIMITER>&lt;%</DELIMITER> d <OPERATOR>+=</OPERATOR> <NUMERIC>1.</NUMERIC>day <DELIMITER>-%&gt;</DELIMITER>
  <DELIMITER>&lt;%</DELIMITER> <KEYWORD>end</KEYWORD> <DELIMITER>-%&gt;</DELIMITER>
&lt;<HTMLTAG>/table</HTMLTAG>&gt;